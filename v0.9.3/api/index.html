<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · ValueShapes</title><link rel="canonical" href="https://oschulz.github.io/ValueShapes.jl/stable/api/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">ValueShapes</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>API</a><ul class="internal"><li><a class="tocitem" href="#Modules"><span>Modules</span></a></li><li><a class="tocitem" href="#Types-and-constants"><span>Types and constants</span></a></li><li><a class="tocitem" href="#Functions-and-macros"><span>Functions and macros</span></a></li><li class="toplevel"><a class="tocitem" href="#Documentation"><span>Documentation</span></a></li></ul></li><li><a class="tocitem" href="../LICENSE/">LICENSE</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/oschulz/ValueShapes.jl/blob/master/docs/src/api.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h1><h2 id="Modules"><a class="docs-heading-anchor" href="#Modules">Modules</a><a id="Modules-1"></a><a class="docs-heading-anchor-permalink" href="#Modules" title="Permalink"></a></h2><ul><li><a href="#ValueShapes.ValueShapes"><code>ValueShapes.ValueShapes</code></a></li></ul><h2 id="Types-and-constants"><a class="docs-heading-anchor" href="#Types-and-constants">Types and constants</a><a id="Types-and-constants-1"></a><a class="docs-heading-anchor-permalink" href="#Types-and-constants" title="Permalink"></a></h2><ul><li><a href="#ValueShapes.AbstractScalarShape"><code>ValueShapes.AbstractScalarShape</code></a></li><li><a href="#ValueShapes.AbstractValueShape"><code>ValueShapes.AbstractValueShape</code></a></li><li><a href="#ValueShapes.ArrayShape"><code>ValueShapes.ArrayShape</code></a></li><li><a href="#ValueShapes.ConstValueDist"><code>ValueShapes.ConstValueDist</code></a></li><li><a href="#ValueShapes.ConstValueShape"><code>ValueShapes.ConstValueShape</code></a></li><li><a href="#ValueShapes.NamedTupleDist"><code>ValueShapes.NamedTupleDist</code></a></li><li><a href="#ValueShapes.NamedTupleShape"><code>ValueShapes.NamedTupleShape</code></a></li><li><a href="#ValueShapes.ReshapedDist"><code>ValueShapes.ReshapedDist</code></a></li><li><a href="#ValueShapes.ScalarShape"><code>ValueShapes.ScalarShape</code></a></li><li><a href="#ValueShapes.ShapedAsNT"><code>ValueShapes.ShapedAsNT</code></a></li><li><a href="#ValueShapes.ShapedAsNTArray"><code>ValueShapes.ShapedAsNTArray</code></a></li><li><a href="#ValueShapes.ValueAccessor"><code>ValueShapes.ValueAccessor</code></a></li></ul><h2 id="Functions-and-macros"><a class="docs-heading-anchor" href="#Functions-and-macros">Functions and macros</a><a id="Functions-and-macros-1"></a><a class="docs-heading-anchor-permalink" href="#Functions-and-macros" title="Permalink"></a></h2><ul><li><a href="#ValueShapes.const_zero"><code>ValueShapes.const_zero</code></a></li><li><a href="#ValueShapes.const_zero_shape-Tuple{ConstValueShape}"><code>ValueShapes.const_zero_shape</code></a></li><li><a href="#ValueShapes.default_datatype"><code>ValueShapes.default_datatype</code></a></li><li><a href="#ValueShapes.default_unshaped_eltype"><code>ValueShapes.default_unshaped_eltype</code></a></li><li><a href="#ValueShapes.elshape"><code>ValueShapes.elshape</code></a></li><li><a href="#ValueShapes.gradient_shape"><code>ValueShapes.gradient_shape</code></a></li><li><a href="#ValueShapes.replace_const_shapes"><code>ValueShapes.replace_const_shapes</code></a></li><li><a href="#ValueShapes.shaped_type"><code>ValueShapes.shaped_type</code></a></li><li><a href="#ValueShapes.stripscalar"><code>ValueShapes.stripscalar</code></a></li><li><a href="#ValueShapes.totalndof"><code>ValueShapes.totalndof</code></a></li><li><a href="#ValueShapes.unshaped"><code>ValueShapes.unshaped</code></a></li><li><a href="#ValueShapes.unshaped"><code>ValueShapes.unshaped</code></a></li><li><a href="#ValueShapes.unshaped-Tuple{Distributions.MultivariateDistribution{S} where S&lt;:Distributions.ValueSupport}"><code>ValueShapes.unshaped</code></a></li><li><a href="#ValueShapes.valshape"><code>ValueShapes.valshape</code></a></li><li><a href="#ValueShapes.vardof-Tuple{Distributions.Distribution}"><code>ValueShapes.vardof</code></a></li><li><a href="#ValueShapes.vardof"><code>ValueShapes.vardof</code></a></li><li><a href="#ValueShapes.varshape"><code>ValueShapes.varshape</code></a></li><li><a href="#ValueShapes.varshape-Tuple{Distributions.UnivariateDistribution{S} where S&lt;:Distributions.ValueSupport}"><code>ValueShapes.varshape</code></a></li><li><a href="#ValueShapes.vs_getindex"><code>ValueShapes.vs_getindex</code></a></li><li><a href="#ValueShapes.vs_setindex!"><code>ValueShapes.vs_setindex!</code></a></li><li><a href="#ValueShapes.vs_unsafe_view"><code>ValueShapes.vs_unsafe_view</code></a></li></ul><h1 id="Documentation"><a class="docs-heading-anchor" href="#Documentation">Documentation</a><a id="Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#Documentation" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="ValueShapes.ValueShapes" href="#ValueShapes.ValueShapes"><code>ValueShapes.ValueShapes</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia">ValueShapes</code></pre><p>Provides a Julia API to describe the shape of values, like scalars, arrays and structures.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ValueShapes.jl/blob/cc8490d0377b085a9e76a35d198d104ca460fd39/src/ValueShapes.jl#L5-L10">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ValueShapes.AbstractScalarShape" href="#ValueShapes.AbstractScalarShape"><code>ValueShapes.AbstractScalarShape</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">AbstractScalarShape{T} &lt;: AbstractValueShape</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ValueShapes.jl/blob/cc8490d0377b085a9e76a35d198d104ca460fd39/src/scalar_shape.jl#L4-L6">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ValueShapes.AbstractValueShape" href="#ValueShapes.AbstractValueShape"><code>ValueShapes.AbstractValueShape</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">abstract type AbstractValueShape</code></pre><p>An <code>AbstractValueShape</code> combines type and size information.</p><p>Subtypes are defined for shapes of scalars (see <a href="#ValueShapes.ScalarShape"><code>ScalarShape</code></a>), arrays (see <a href="#ValueShapes.ArrayShape"><code>ArrayShape</code></a>), constant values (see <a href="#ValueShapes.ConstValueShape"><code>ConstValueShape</code></a>) and <code>NamedTuple</code>s (see <a href="#ValueShapes.NamedTupleShape"><code>NamedTupleShape</code></a>).</p><p>Subtypes of <code>AbstractValueShape</code> must support <code>eltype</code>, <code>size</code> and <a href="#ValueShapes.totalndof"><code>totalndof</code></a>.</p><p>Value shapes can be used as constructors to generate values of the given shape with undefined content. If the element type of the shape is an abstract or union type, a suitable concrete type will be chosen automatically, if possible (see <a href="#ValueShapes.default_datatype"><code>ValueShapes.default_datatype</code></a>):</p><pre><code class="language-julia">shape = ArrayShape{Real}(2,3)
A = shape(undef)
typeof(A) == Array{Float64,2}
size(A) == (2, 3)
valshape(A) == ArrayShape{Float64}(2,3)</code></pre><p>Use</p><pre><code class="language-none">(shape::AbstractValueShape)(data::AbstractVector{&lt;:Real})::eltype(shape)</code></pre><p>to view a flat vector of anonymous real values as a value of the given shape:</p><pre><code class="language-julia">data = [1, 2, 3, 4, 5, 6]
shape(data) == [1 3 5; 2 4 6]</code></pre><p>In return,</p><pre><code class="language-none">Base.Vector{&lt;:Real}(undef, shape::AbstractValueShape)</code></pre><p>will create a suitable uninitialized vector of the right length to hold such flat data for the given shape. If no type <code>T</code> is given, a suitable data type will be chosen automatically.</p><p>When dealing with multiple vectors of flattened data, use</p><pre><code class="language-none">shape.(data::ArraysOfArrays.AbstractVectorOfSimilarVectors)</code></pre><p>ValueShapes supports this via specialized broadcasting.</p><p>In return,</p><pre><code class="language-none">ArraysOfArrays.VectorOfSimilarVectors{&lt;:Real}(shape::AbstractValueShape)</code></pre><p>will create a suitable vector (of length zero) of vectors that can hold flattened data for the given shape. The result will be a <code>VectorOfSimilarVectors</code> wrapped around a 2-dimensional <code>ElasticArray</code>. This way, all data is stored in a single contiguous chunk of memory.</p><p><code>AbstractValueShape</code>s can be compared with <code>&lt;=</code> and <code>&gt;=</code>, with semantics that are similar to compare type with <code>&lt;:</code> and <code>&gt;:</code>:</p><pre><code class="language-julia">a::AbstractValueShape &lt;= b::AbstractValueShape == true</code></pre><p>implies that values of shape <code>a</code> are can be used in contexts that expect values of shape <code>b</code>. E.g.:</p><pre><code class="language-julia">(ArrayShape{Float64}(4,5) &lt;= ArrayShape{Real}(4,5)) == true
(ArrayShape{Float64}(4,5) &lt;= ArrayShape{Integer}(4,5)) == false
(ArrayShape{Float64}(2,2) &lt;= ArrayShape{Float64}(3,3)) == false
(ScalarShape{Real}() &gt;= ScalarShape{Int}()) == true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ValueShapes.jl/blob/cc8490d0377b085a9e76a35d198d104ca460fd39/src/value_shape.jl#L24-L101">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ValueShapes.ArrayShape" href="#ValueShapes.ArrayShape"><code>ValueShapes.ArrayShape</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">ArrayShape{T,N} &lt;: AbstractValueShape</code></pre><p>Describes the shape of <code>N</code>-dimensional arrays of type <code>T</code> and a given size.</p><p>Constructor:</p><pre><code class="language-none">ArrayShape{T}(dims::NTuple{N,Integer}) where {T,N}
ArrayShape{T}(dims::Integer...) where {T}</code></pre><p>e.g.</p><pre><code class="language-none">shape = ArrayShape{Real}(2, 3)</code></pre><p>See also the documentation of <a href="#ValueShapes.AbstractValueShape"><code>AbstractValueShape</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ValueShapes.jl/blob/cc8490d0377b085a9e76a35d198d104ca460fd39/src/array_shape.jl#L4-L19">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ValueShapes.ConstValueDist" href="#ValueShapes.ConstValueDist"><code>ValueShapes.ConstValueDist</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">ConstValueDist &lt;: Distributions.Distribution</code></pre><p>Represents a delta distribution for a constant value of arbritrary type.</p><p>Calling <code>varshape</code> on a <code>ConstValueDist</code> will yield a <a href="#ValueShapes.ConstValueShape"><code>ConstValueShape</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ValueShapes.jl/blob/cc8490d0377b085a9e76a35d198d104ca460fd39/src/const_value_dist.jl#L4-L11">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ValueShapes.ConstValueShape" href="#ValueShapes.ConstValueShape"><code>ValueShapes.ConstValueShape</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">ConstValueShape{T} &lt;: AbstractValueShape</code></pre><p>A <code>ConstValueShape</code> describes the shape of constant values of type <code>T</code>.</p><p>Constructor:</p><pre><code class="language-none">ConstValueShape(value)</code></pre><p><code>value</code> may be of arbitrary type, e.g. a constant scalar value or array:</p><pre><code class="language-none">ConstValueShape(4.2)
ConstValueShape([11 21; 12 22])</code></pre><p>Shapes of constant values have zero degrees of freedom (see <a href="#ValueShapes.totalndof"><code>totalndof</code></a>).</p><p>See also the documentation of <a href="#ValueShapes.AbstractValueShape"><code>AbstractValueShape</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ValueShapes.jl/blob/cc8490d0377b085a9e76a35d198d104ca460fd39/src/const_value_shape.jl#L4-L22">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ValueShapes.NamedTupleDist" href="#ValueShapes.NamedTupleDist"><code>ValueShapes.NamedTupleDist</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">NamedTupleDist &lt;: MultivariateDistribution
NamedTupleDist &lt;: MultivariateDistribution</code></pre><p>A distribution with <code>NamedTuple</code>-typed variates.</p><p><code>NamedTupleDist</code> provides an effective mechanism to specify the distribution of each variable/parameter in a set of named variables/parameters.</p><p>Calling <code>varshape</code> on a <code>NamedTupleDist</code> will yield a <a href="#ValueShapes.NamedTupleShape"><code>NamedTupleShape</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ValueShapes.jl/blob/cc8490d0377b085a9e76a35d198d104ca460fd39/src/named_tuple_dist.jl#L14-L25">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ValueShapes.NamedTupleShape" href="#ValueShapes.NamedTupleShape"><code>ValueShapes.NamedTupleShape</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">NamedTupleShape{names,...} &lt;: AbstractValueShape</code></pre><p>Defines the shape of a <code>NamedTuple</code> (resp.  set of variables, parameters, etc.).</p><p>Constructors:</p><pre><code class="language-none">NamedTupleShape(name1 = shape1::AbstractValueShape, ...)
NamedTupleShape(named_shapes::NamedTuple)</code></pre><p>Example:</p><pre><code class="language-julia">shape = NamedTupleShape(
    a = ScalarShape{Real}(),
    b = ArrayShape{Real}(2, 3),
    c = ConstValueShape(42)
)

data = VectorOfSimilarVectors{Float64}(shape)
resize!(data, 10)
rand!(flatview(data))
table = shape.(data)
fill!(table.a, 4.2)
all(x -&gt; x == 4.2, view(flatview(data), 1, :))</code></pre><p>See also the documentation of <a href="#ValueShapes.AbstractValueShape"><code>AbstractValueShape</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ValueShapes.jl/blob/cc8490d0377b085a9e76a35d198d104ca460fd39/src/named_tuple_shape.jl#L10-L39">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ValueShapes.ReshapedDist" href="#ValueShapes.ReshapedDist"><code>ValueShapes.ReshapedDist</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">ReshapedDist &lt;: Distribution</code></pre><p>An multivariate distribution reshaped using a given <a href="#ValueShapes.AbstractValueShape"><code>AbstractValueShape</code></a>.</p><p>Constructors:</p><pre><code class="language-julia">    ReshapedDist(dist::MultivariateDistribution, shape::AbstractValueShape)</code></pre><p>In addition, <code>MultivariateDistribution</code>s can be reshaped via</p><pre><code class="language-julia">(shape::AbstractValueShape)(dist::MultivariateDistribution)</code></pre><p>with the difference that</p><pre><code class="language-julia">(shape::ArrayShape{T,1})(dist::MultivariateDistribution)</code></pre><p>will return the original <code>dist</code> instead of a <code>ReshapedDist</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ValueShapes.jl/blob/cc8490d0377b085a9e76a35d198d104ca460fd39/src/reshaped_dist.jl#L4-L29">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ValueShapes.ScalarShape" href="#ValueShapes.ScalarShape"><code>ValueShapes.ScalarShape</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">ScalarShape{T} &lt;: AbstractScalarShape{T}</code></pre><p>An <code>ScalarShape</code> describes the shape of scalar values of a given type.</p><p>Constructor:</p><pre><code class="language-none">ScalarShape{T::Type}()</code></pre><p>T may be an abstract type of Union, or a specific type, e.g.</p><pre><code class="language-none">ScalarShape{Real}()
ScalarShape{Integer}()
ScalarShape{Float32}()
ScalarShape{Complex}()</code></pre><p>Scalar shapes may have a total number of degrees of freedom (see <a href="#ValueShapes.totalndof"><code>totalndof</code></a>) greater than one, e.g. shapes of complex-valued scalars:</p><pre><code class="language-none">totalndof(ScalarShape{Real}()) == 1
totalndof(ScalarShape{Complex}()) == 2</code></pre><p>See also the documentation of <a href="#ValueShapes.AbstractValueShape"><code>AbstractValueShape</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ValueShapes.jl/blob/cc8490d0377b085a9e76a35d198d104ca460fd39/src/scalar_shape.jl#L31-L55">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ValueShapes.ShapedAsNT" href="#ValueShapes.ShapedAsNT"><code>ValueShapes.ShapedAsNT</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">ShapedAsNT{T&lt;:NamedTuple,...} &lt;: AbstractArray{T,0}</code></pre><p>View of an <code>AbstractVector{&lt;:Real}</code> as a zero-dimensional Array containing a <code>NamedTuple</code>, according to a specified <a href="#ValueShapes.NamedTupleShape"><code>NamedTupleShape</code></a>.</p><p>Constructors:</p><pre><code class="language-none">ShapedAsNT(data::AbstractVector{&lt;:Real}, shape::NamedTupleShape)

shape(data)</code></pre><p>The resulting <code>ShapedAsNT</code> shares memory with <code>data</code>. It takes the form of a (virtual) zero-dimensional Array to make the contents as editable as <code>data</code> itself (compared to a standard immutable NamedTuple):</p><pre><code class="language-julia">x = (a = 42, b = rand(1:9, 2, 3))
shape = valshape(x)
data = Vector{Int}(undef, shape)
y = shape(data)
@assert y isa ShapedAsNT
y[] = x
@assert y[] == x
y.a = 22
y.a[] = 33
@assert shape(data) == y
@assert unshaped(y) === data</code></pre><p>Use <code>unshaped(x)</code> to access <code>data</code> directly.</p><p>See also <a href="#ValueShapes.ShapedAsNTArray"><code>ShapedAsNTArray</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ValueShapes.jl/blob/cc8490d0377b085a9e76a35d198d104ca460fd39/src/named_tuple_shape.jl#L165-L198">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ValueShapes.ShapedAsNTArray" href="#ValueShapes.ShapedAsNTArray"><code>ValueShapes.ShapedAsNTArray</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">ShapedAsNTArray{T&lt;:NamedTuple,...} &lt;: AbstractArray{T,N}</code></pre><p>View of an <code>AbstractArray{&lt;:AbstractVector{&lt;:Real},N}</code> as an array of <code>NamedTuple</code>s, according to a specified <a href="#ValueShapes.NamedTupleShape"><code>NamedTupleShape</code></a>.</p><p><code>ShapedAsNTArray</code> implements the <code>Tables</code> API. Semantically, it acts a broadcasted <a href="#ValueShapes.ShapedAsNT"><code>ShapedAsNT</code></a>.</p><p>Constructors:</p><pre><code class="language-none">ShapedAsNTArray(
    data::AbstractArray{&lt;:AbstractVector{&lt;:Real},
    shape::NamedTupleShape
)

shape.(data)</code></pre><p>The resulting <code>ShapedAsNTArray</code> shares memory with <code>data</code>:</p><pre><code class="language-julia">using ArraysOfArrays, Tables, TypedTables

X = [
    (a = 42, b = rand(1:9, 2, 3))
    (a = 11, b = rand(1:9, 2, 3))
]

shape = valshape(X[1])
data = nestedview(Array{Int}(undef, totalndof(shape), 2))
Y = shape.(data)
@assert Y isa ShapedAsNTArray
Y[:] = X
@assert Y[1] == X[1] == shape(data[1])[]
@assert Y.a == [42, 11]
Tables.columns(Y)
@assert unshaped.(Y) === data
@assert Table(Y) isa TypedTables.Table</code></pre><p>Use <code>unshaped.(Y)</code> to access <code>data</code> directly.</p><p><code>Tables.columns(Y)</code> will return a <code>NamedTuple</code> of columns. They will contain a copy the data, using a memory layout as contiguous as possible for each column.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ValueShapes.jl/blob/cc8490d0377b085a9e76a35d198d104ca460fd39/src/named_tuple_shape.jl#L400-L445">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ValueShapes.ValueAccessor" href="#ValueShapes.ValueAccessor"><code>ValueShapes.ValueAccessor</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">ValueAccessor{S&lt;:AbstractValueShape}</code></pre><p>A value accessor provides a means to access a value with a given shape stored in a flat real-valued data vector with a given offset position.</p><p>Constructor:</p><pre><code class="language-none">ValueAccessor{S}(shape::S, offset::Int)</code></pre><p>The offset is relative to the first index of a flat data array, so if the value is stored at the beginning of the array, the offset will be zero.</p><p>An <code>ValueAccessor</code> can be used to index into a given flat data array.</p><p>Example:</p><pre><code class="language-julia">acc = ValueAccessor(ArrayShape{Real}(2,3), 2)
valshape(acc) == ArrayShape{Real,2}((2, 3))
data = [1, 2, 3, 4, 5, 6, 7, 8, 9]
data[acc] == [3 5 7; 4 6 8]</code></pre><p>Note: Subtypes of <a href="#ValueShapes.AbstractValueShape"><code>AbstractValueShape</code></a> should specialize <a href="#ValueShapes.vs_getindex"><code>ValueShapes.vs_getindex</code></a>, <a href="#ValueShapes.vs_unsafe_view"><code>ValueShapes.vs_unsafe_view</code></a> and <a href="#ValueShapes.vs_setindex!"><code>ValueShapes.vs_setindex!</code></a> for their <code>ValueAccessor{...}</code>. Specializing <code>Base.getindex</code>, <code>Base.view</code>, <code>Base.unsafe_view</code> or <code>Base.setindex!</code> directly may result in method ambiguities with custom array tapes that specialize these functions in a very generic fashion.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ValueShapes.jl/blob/cc8490d0377b085a9e76a35d198d104ca460fd39/src/value_accessor.jl#L4-L34">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ValueShapes.const_zero" href="#ValueShapes.const_zero"><code>ValueShapes.const_zero</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">const_zero(x::Any)</code></pre><p>Get the equivalent of a constant zero for values the same type as .</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ValueShapes.jl/blob/cc8490d0377b085a9e76a35d198d104ca460fd39/src/value_shape.jl#L341-L345">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ValueShapes.const_zero_shape-Tuple{ConstValueShape}" href="#ValueShapes.const_zero_shape-Tuple{ConstValueShape}"><code>ValueShapes.const_zero_shape</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">const_zero_shape(shape::ConstValueShape)</code></pre><p>Get the equivalent of a constant zero shape for shape <code>shape</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ValueShapes.jl/blob/cc8490d0377b085a9e76a35d198d104ca460fd39/src/const_value_shape.jl#L56-L60">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ValueShapes.default_datatype" href="#ValueShapes.default_datatype"><code>ValueShapes.default_datatype</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">ValueShapes.default_datatype(T::Type)</code></pre><p>Return a default specific type U that is more specific than T, with U &lt;: T.</p><p>e.g.</p><pre><code class="language-none">ValueShapes.default_datatype(Real) == Float64
ValueShapes.default_datatype(Complex) == Complex{Float64}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ValueShapes.jl/blob/cc8490d0377b085a9e76a35d198d104ca460fd39/src/value_shape.jl#L4-L13">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ValueShapes.default_unshaped_eltype" href="#ValueShapes.default_unshaped_eltype"><code>ValueShapes.default_unshaped_eltype</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">ValueShapes.default_unshaped_eltype(shape::AbstractValueShape)</code></pre><p>Returns the default real array element type to use for unshaped representations of data with shape <code>shape</code>.</p><p>Subtypes of <code>AbstractValueShape</code> must implemenent <code>ValueShapes.default_unshaped_eltype</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ValueShapes.jl/blob/cc8490d0377b085a9e76a35d198d104ca460fd39/src/value_shape.jl#L119-L127">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ValueShapes.elshape" href="#ValueShapes.elshape"><code>ValueShapes.elshape</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">elshape(x)::AbstractValueShape</code></pre><p>Get the shape of the elements of x</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ValueShapes.jl/blob/cc8490d0377b085a9e76a35d198d104ca460fd39/src/value_shape.jl#L160-L164">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ValueShapes.gradient_shape" href="#ValueShapes.gradient_shape"><code>ValueShapes.gradient_shape</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">gradient_shape(argshape::AbstractValueShape)</code></pre><p>Return the value shape of the gradient of functions that take values of shape <code>argshape</code> as an input.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ValueShapes.jl/blob/cc8490d0377b085a9e76a35d198d104ca460fd39/src/value_shape.jl#L362-L367">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ValueShapes.replace_const_shapes" href="#ValueShapes.replace_const_shapes"><code>ValueShapes.replace_const_shapes</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">replace_const_shapes(f::Function, shape::AbstractValueShape)</code></pre><p>If <code>shape</code> is a, or contains, <a href="#ValueShapes.ConstValueShape"><code>ConstValueShape</code></a> shape(s), recursively replace it/them with the result of <code>f(s::Shape)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ValueShapes.jl/blob/cc8490d0377b085a9e76a35d198d104ca460fd39/src/value_shape.jl#L352-L357">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ValueShapes.shaped_type" href="#ValueShapes.shaped_type"><code>ValueShapes.shaped_type</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">ValueShapes.shaped_type(shape::AbstractValueShape, ::Type{T}) where {T&lt;:Real}
ValueShapes.shaped_type(shape::AbstractValueShape)</code></pre><p>Returns the type the will result from reshaping a real-valued vector (of element type <code>T</code>, if specified) with <code>shape</code>.</p><p>Subtypes of <code>AbstractValueShape</code> must implement</p><pre><code class="language-none">ValueShapes.shaped_type(shape::AbstractValueShape, ::Type{T}) where {T&lt;:Real}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ValueShapes.jl/blob/cc8490d0377b085a9e76a35d198d104ca460fd39/src/value_shape.jl#L131-L141">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ValueShapes.stripscalar" href="#ValueShapes.stripscalar"><code>ValueShapes.stripscalar</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">stripscalar(x)</code></pre><p>Dereference value <code>x</code>.</p><p>If x is a scalar-like object, like a 0-dimensional array or a <code>Ref</code>, <code>stripscalar</code> returns it&#39;s inner value. Otherwise, <code>x</code> is returned unchanged.</p><p>Useful to strip shaped scalar-like views of their 0-dim array semantics (if present), but leave array-like views unchanged.</p><p>Example:</p><pre><code class="language-julia">data = [1, 2, 3]
shape1 = NamedTupleShape(a = ScalarShape{Real}(), b = ArrayShape{Real}(2))
x1 = shape1(data)
@assert x1 isa AbstractArray{&lt;:NamedTuple,0}
@assert stripscalar(x) isa NamedTuple

shape2 = ArrayShape{Real}(3)
x2 = shape2(data)
@assert x2 isa AbstractArray{Int,1}
@assert ref(x2) isa AbstractArray{Int,1}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ValueShapes.jl/blob/cc8490d0377b085a9e76a35d198d104ca460fd39/src/value_shape.jl#L223-L248">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ValueShapes.totalndof" href="#ValueShapes.totalndof"><code>ValueShapes.totalndof</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">totalndof(shape::AbstractValueShape)</code></pre><p>Get the total number of degrees of freedom of values of the given shape.</p><p>Equivalent to the length of a vector that would result from flattening the data into a sequence of real numbers, excluding any constant values.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ValueShapes.jl/blob/cc8490d0377b085a9e76a35d198d104ca460fd39/src/value_shape.jl#L173-L180">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ValueShapes.unshaped" href="#ValueShapes.unshaped"><code>ValueShapes.unshaped</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">unshaped(x)::AbstractVector{&lt;:Real}
unshaped(x, shape::AbstractValueShape)::AbstractVector{&lt;:Real}</code></pre><p>Retrieve the unshaped underlying data of x, assuming x is a structured view (based on some <a href="#ValueShapes.AbstractValueShape"><code>AbstractValueShape</code></a>) of a flat/unstructured real-valued data vector.</p><p>If <code>shape</code> is given, ensures that the shape of <code>x</code> is compatible with it. Specifying a shape may be necessary if the correct shape of <code>x</code> cannot be inferred from <code>x</code>, e.g. because <code>x</code> is assumed to have fewer degrees of freedom (because of constant components) than would be inferred from the plain value of <code>x</code>.</p><p>Example:</p><pre><code class="language-julia">shape = NamedTupleShape(
    a = ScalarShape{Real}(),
    b = ArrayShape{Real}(2, 3)
)
data = [1, 2, 3, 4, 5, 6, 7]
x = shape(data)
@assert unshaped(x) == data
@assert unshaped(x.a) == view(data, 1:1)
@assert unshaped(x.b) == view(data, 2:7)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ValueShapes.jl/blob/cc8490d0377b085a9e76a35d198d104ca460fd39/src/value_shape.jl#L185-L212">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ValueShapes.unshaped" href="#ValueShapes.unshaped"><code>ValueShapes.unshaped</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">unshaped(
    f::Function,
    orig_varshape::Union{Nothing,AbstractValueShape},
    orig_valshape::Union{Nothing,AbstractValueShape} = nothing
)</code></pre><p>Return a function that     * Shapes it&#39;s input from a flat vector of <code>Real</code> using <code>orig_varshape</code>, if not <code>nothing</code>.     * Calls <code>f</code> with the (optionally) unshaped input.     * Unshapes the result to a flat vector of <code>Real</code> using <code>orig_valshape</code>, if not <code>nothing</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ValueShapes.jl/blob/cc8490d0377b085a9e76a35d198d104ca460fd39/src/functions.jl#L49-L60">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ValueShapes.unshaped-Tuple{Distributions.MultivariateDistribution{S} where S&lt;:Distributions.ValueSupport}" href="#ValueShapes.unshaped-Tuple{Distributions.MultivariateDistribution{S} where S&lt;:Distributions.ValueSupport}"><code>ValueShapes.unshaped</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">unshaped(d::Distributions.Distribution)</code></pre><p>Turns <code>d</code> into a <code>Distributions.Distribution{Multivariate}</code> based on <code>varshape(d)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ValueShapes.jl/blob/cc8490d0377b085a9e76a35d198d104ca460fd39/src/distributions.jl#L25-L30">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ValueShapes.valshape" href="#ValueShapes.valshape"><code>ValueShapes.valshape</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">valshape(x)::AbstractValueShape
valshape(acc::ValueAccessor)::AbstractValueShape</code></pre><p>Get the value shape of an arbitrary value, resp. the shape a <code>ValueAccessor</code> is based on, or the shape of the variates for a <code>Distribution</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ValueShapes.jl/blob/cc8490d0377b085a9e76a35d198d104ca460fd39/src/value_shape.jl#L147-L153">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ValueShapes.vardof" href="#ValueShapes.vardof"><code>ValueShapes.vardof</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">vardof(f::Function)::Integer</code></pre><p>Get the number of degrees of freedom of the input/argument of f.</p><p>Equivalent to <code>totalndof(varshape(f))</code> (see <a href="#ValueShapes.varshape"><code>varshape</code></a>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ValueShapes.jl/blob/cc8490d0377b085a9e76a35d198d104ca460fd39/src/functions.jl#L22-L28">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ValueShapes.vardof-Tuple{Distributions.Distribution}" href="#ValueShapes.vardof-Tuple{Distributions.Distribution}"><code>ValueShapes.vardof</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">vardof(d::Distributions.Distribution)</code></pre><p>Get the number of degrees of freedom of the variates of distribution <code>d</code>. Equivalent to <code>totalndof(varshape(d))</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ValueShapes.jl/blob/cc8490d0377b085a9e76a35d198d104ca460fd39/src/distributions.jl#L16-L21">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ValueShapes.varshape" href="#ValueShapes.varshape"><code>ValueShapes.varshape</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">varshape(f::Function)::AbstractValueShape</code></pre><p>Get the value shape of the input/argument of an unary function <code>f</code>. <code>f</code> should support call syntax</p><pre><code class="language-none">f(x::T)</code></pre><p>with <code>valshape(x) == varshape(f)</code> as well all</p><pre><code class="language-none">f(x::AbstractVector{&lt;:Real})</code></pre><p>with <code>length(eachindex(x)) == vardof(f)</code> (see <a href="#ValueShapes.vardof"><code>vardof</code></a>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ValueShapes.jl/blob/cc8490d0377b085a9e76a35d198d104ca460fd39/src/functions.jl#L4-L17">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ValueShapes.varshape-Tuple{Distributions.UnivariateDistribution{S} where S&lt;:Distributions.ValueSupport}" href="#ValueShapes.varshape-Tuple{Distributions.UnivariateDistribution{S} where S&lt;:Distributions.ValueSupport}"><code>ValueShapes.varshape</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">varshape(d::Distributions.Distribution)::AbstractValueShape</code></pre><p>Get the value shape of the variates of distribution <code>d</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ValueShapes.jl/blob/cc8490d0377b085a9e76a35d198d104ca460fd39/src/distributions.jl#L4-L8">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ValueShapes.vs_getindex" href="#ValueShapes.vs_getindex"><code>ValueShapes.vs_getindex</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">ValueShapes.vs_getindex(data::AbstractArray{&lt;:Real}, idxs::ValueAccessor...)</code></pre><p>Specialize <code>ValueShapes.vs_getindex</code> instead of <code>Base.getindex</code> for <a href="#ValueShapes.ValueAccessor"><code>ValueShapes.ValueAccessor</code></a>s, to avoid methods ambiguities with with certain custom array types.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ValueShapes.jl/blob/cc8490d0377b085a9e76a35d198d104ca460fd39/src/value_accessor.jl#L91-L97">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ValueShapes.vs_setindex!" href="#ValueShapes.vs_setindex!"><code>ValueShapes.vs_setindex!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">ValueShapes.vs_setindex!(data::AbstractArray{&lt;:Real}, v, idxs::ValueAccessor...)</code></pre><p>Specialize <code>ValueShapes.vs_setindex!</code> instead of <code>Base.setindex!</code> or for <a href="#ValueShapes.ValueAccessor"><code>ValueShapes.ValueAccessor</code></a>s, to avoid methods ambiguities with with certain custom array types.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ValueShapes.jl/blob/cc8490d0377b085a9e76a35d198d104ca460fd39/src/value_accessor.jl#L129-L135">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ValueShapes.vs_unsafe_view" href="#ValueShapes.vs_unsafe_view"><code>ValueShapes.vs_unsafe_view</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">ValueShapes.vs_unsafe_view(data::AbstractArray{&lt;:Real}, idxs::ValueAccessor...)</code></pre><p>Specialize <code>ValueShapes.vs_unsafe_view</code> instead of <code>Base.view</code> or <code>Base.unsafe_view</code> for <a href="#ValueShapes.ValueAccessor"><code>ValueShapes.ValueAccessor</code></a>s, to avoid methods ambiguities with with certain custom array types.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oschulz/ValueShapes.jl/blob/cc8490d0377b085a9e76a35d198d104ca460fd39/src/value_accessor.jl#L110-L116">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../LICENSE/">LICENSE »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 2 June 2021 16:01">Wednesday 2 June 2021</span>. Using Julia version 1.6.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

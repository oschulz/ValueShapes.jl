<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · ValueShapes</title><link rel="canonical" href="https://oschulz.github.io/ValueShapes.jl/stable/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">ValueShapes</span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a></li><li><a class="tocitem" href="api/">API</a></li><li><a class="tocitem" href="LICENSE/">LICENSE</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/oschulz/ValueShapes.jl/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="ValueShapes.jl-1"><a class="docs-heading-anchor" href="#ValueShapes.jl-1">ValueShapes.jl</a><a class="docs-heading-anchor-permalink" href="#ValueShapes.jl-1" title="Permalink"></a></h1><p>ValueShapes provides Julia types to describe the shape of values, like scalars, arrays and structures.</p><p>Shapes provide a generic way to construct uninitialized values (e.g. multidimensional arrays) without using templates.</p><p>Shapes also act as a bridge between structured and flat data representations: Mathematical and statistical algorithms (e.g. optimizers, fitters, solvers, etc.) often represent variables/parameters as flat vectors of nameless real values. But user code will usually be more concise and readable if variables/parameters can have names (e.g. via <code>NamedTuple</code>s) and non-scalar shapes. ValueShapes provides a duality of view between the two different data representations.</p><p>ValueShapes defines the shape of a value as the combination of it&#39;s data type (resp. element type, in the case of arrays) and the size of the value (relevant if the value is an array), e.g.</p><pre><code class="language-julia">using ValueShapes

ScalarShape{Real}()
ArrayShape{Real}(2, 3)
ConstValueShape([1 2; 3 4])</code></pre><p>Array shapes can be used to construct a compatible real-valued data vector:</p><pre><code class="language-julia">Vector{Float64}(undef, ArrayShape{Real}(2, 3)) isa Vector{Float64}</code></pre><p>ValueShapes also provides a way to define the shape of a <code>NamedTuple</code>. This can be used to specify the names and shapes of a set of variables or parameters. Consider a fitting problem with the following parameters: A scalar <code>a</code>, a 2x3 array <code>b</code> and an array <code>c</code> pinned to a fixed value. This set parameters can be specified as</p><pre><code class="language-julia">parshapes = NamedTupleShape(
    a = ScalarShape{Real}(),
    b = ArrayShape{Real}(2, 3),
    c = ConstValueShape([1 2; 3 4])
)</code></pre><p>This set of parameters has</p><pre><code class="language-julia">totalndof(parshapes) == 7</code></pre><p>total degrees of freedom (the constant <code>c</code> does not contribute). The flat data representation for this <code>NamedTupleShape</code> is a vector of length 7:</p><pre><code class="language-julia">using Random

data = Vector{Float64}(undef, parshapes)
size(data) == (7,)
rand!(data)</code></pre><p>which can again be viewed as a <code>NamedTuple</code> described by <code>shape</code> via</p><pre><code class="language-julia">data_as_ntuple = parshapes(data)

data_as_ntuple isa ShapedAsNT{&lt;:NamedTuple{(:a, :b, :c)}}</code></pre><p>(See <a href="api/#ValueShapes.ShapedAsNT"><code>ShapedAsNT</code></a>.)</p><p>Note: The package <a href="https://github.com/tpapp/EponymTuples.jl">EponymTuples</a> may come in handy to define functions that take such tuples as parameters and deconstruct them, so that the variable names can be used directly inside the function body. The macro <code>@unpack</code> provided by the package <a href="https://github.com/mauro3/Parameters.jl">Parameters</a> can be used to unpack <code>NamedTuple</code>s selectively.</p><p>ValueShapes can also handle multiple values for sets of variables and is designed to compose well with <a href="https://github.com/oschulz/ArraysOfArrays.jl">ArraysOfArrays.jl</a> and <a href="https://github.com/JuliaData/Tables.jl">Tables.jl</a> (and similar table packages). Broadcasting a shape over a vector of real-valued vectors will create a view that implements the Tables.jl API:</p><pre><code class="language-julia">using ArraysOfArrays, Tables, TypedTables

multidata = VectorOfSimilarVectors{Int}(parshapes)
resize!(multidata, 10)
rand!(flatview(multidata), 0:99)

A = parshapes.(multidata)
keys(Tables.columns(A)) == (:a, :b, :c)</code></pre><p>ValueShapes supports this via specialized broadcasting. <code>A</code> is now a table-like view into the data (see <a href="api/#ValueShapes.ShapedAsNTArray"><code>ShapedAsNTArray</code></a>), and shares memory with <code>multidata</code>. To create an independent <code>NamedTuple</code> of columns, with a contiguous memory layout for each column, use <code>Tables.columns(A)</code>:</p><pre><code class="language-julia">tcols = Tables.columns(A)
flatview(tcols.b) isa Array{Int}</code></pre><p>Constructing a <code>TypedTables.Table</code>, <code>DataFrames.DataFrame</code> or similar from <code>A</code> will have the same effect:</p><pre><code class="language-julia">using TypedTables
flatview(Table(A).b) isa Array{Int}

using DataFrames
flatview(DataFrame(A).b) isa Array{Int}</code></pre></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="api/">API »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 30 September 2020 22:15">Wednesday 30 September 2020</span>. Using Julia version 1.5.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
